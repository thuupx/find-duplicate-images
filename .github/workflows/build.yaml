name: Build Executables

on:
  workflow_dispatch:
    inputs:
      platform:
        type: choice
        description: 'Select platform to build'
        required: true
        options:
          - windows
          - macos
          - linux

jobs:
  build:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        include:
          - platform: windows
            os: windows-latest
          - platform: macos
            os: macos-latest
          - platform: linux
            os: ubuntu-latest
    if: github.event.inputs.platform == matrix.platform
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Create Executable
        uses: sayyid5416/pyinstaller@v1
        with:
          python_ver: '3.12'
          pyinstaller_ver: '==6.10.0'
          spec: 'snap_sweeper.spec'
          requirements: 'requirements.txt'
          upload_exe_with_name: 'Snap Sweeper'
          # upload_exe_with_name: ${{ matrix.platform == 'windows' && 'Snap Sweeper' || '' }}
